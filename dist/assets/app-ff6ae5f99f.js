!function(){"use strict";angular.module("route-test-app",["svg-icons","as.sortable","ngNotify","templates","vendors"])}(),function(){"use strict";angular.module("svg-icons",[])}(),function(){"use strict";angular.module("vendors",[]).constant("_",window._)}(),function(){"use strict";function t(t,e,n,o){function r(o,r){if(!angular.isDefined(s.map))return void t.error("You should pass to vm.map public api of map");if(o.keyCode===c){if(r=n.trim(r),!r.length)return void e.error("Нельзя добавить точку без имени");s.map.getCenter().then(function(t){return n.find(s.points,{coordinates:t})?void e.error("Точка с такими координатами уже существует"):(s.points.push({name:r,coordinates:t}),void(s.pointName=""))})}}function i(t){var e;return e=0===t?o.labelFirst.iconColor:t===s.points.length-1?o.labelLast.iconColor:o.label.iconColor,{fill:e}}function a(t,e){s.points[t].coordinates=e}var s=this,c=13;s.pointName="",s.points=[],s.addPoint=r,s.removePoint=n.remove.bind(n,s.points),s.getPointStyle=i,s.onDragPoint=a}t.$inject=["$log","ngNotify","_","MAP_DECOR_PARAMS"],angular.module("route-test-app").controller("RouteEditorCtrl",t)}(),function(){"use strict";function t(){return{restrict:"E",controller:"RouteEditorCtrl",controllerAs:"routeEditor",scope:{},templateUrl:"/src/route-test-app/components/route-editor/route-editor.html"}}angular.module("route-test-app").directive("routeEditor",t)}(),function(){"use strict";function t(t,e,n,o,r,i,a){function s(n){t.all({ymaps:e.getMaps(),center:f._getUserLocation()}).then(function(t){var e=angular.extend({},i,{center:t.center});f.isLoading=!1,m.resolve({ymaps:t.ymaps,instance:new t.ymaps.Map(n,e)})})}function c(){f._map.then(function(t){t.instance.destroy()})}function u(){return f._map.then(function(t){return t.instance.getCenter()})}function l(t){f._map.then(function(e){e.instance.geoObjects.removeAll(),f._buildGeoObjects(e.ymaps,t).forEach(function(t){e.instance.geoObjects.add(t)})})}function d(t,e){var n=new t.GeoObject({geometry:new t.geometry.LineString(e.map(function(t){return t.coordinates}))},a.line),o=[n],i=e.length-1;return e.forEach(function(e,a){var s=new t.GeoObject({geometry:new t.geometry.Point(e.coordinates),properties:{balloonContent:e.name}},f._getLabelOptions(a,i));s.events.add("drag",function(){n.geometry.set(a,s.geometry.getCoordinates())}),angular.isFunction(f.onDragPoint)&&s.events.add("dragend",r.throttle(function(){f.onDragPoint({index:a,coordinates:s.geometry.getCoordinates()})},100)),o.push(s)}),o}function p(t,e){var n=angular.extend({},a.label);return 0===t?angular.extend(n,a.labelFirst):t===e&&angular.extend(n,a.labelLast),n}function g(){function e(t){r.resolve(t||i.center)}var r=t.defer();return n.isSupports()?n.getCurrentCoordinates().then(e)["catch"](function(){o.warn("Вы запретили использовать определение своей локации. Будут использованы стандартные координаты"),e()}):(o.warn("Ваш браузер не поддерживает определение локации. Будут использованы стандартные координаты"),e()),r.promise}var f=this,m=t.defer();f.mapApi={getCenter:u},f.isLoading=!0,f.construct=s,f.destroy=c,f.redrawRoute=l,f._map=m.promise,f._buildGeoObjects=d,f._getLabelOptions=p,f._getUserLocation=g}t.$inject=["$q","YandexMapLoader","Geolocation","ngNotify","_","MAP_DEFAULT_PARAMS","MAP_DECOR_PARAMS"],angular.module("route-test-app").controller("YandexMapCtrl",t)}(),function(){"use strict";function t(t,e){function n(){var n='You must load yandex maps js before using "yandex-map" component',o=t.defer();return"ymaps"in window?window.ymaps.ready(function(){o.resolve(window.ymaps)}):(e.error(n),o.reject({message:n})),o.promise}return{getMaps:n}}t.$inject=["$q","$log"],angular.module("route-test-app").factory("YandexMapLoader",t)}(),function(){"use strict";function t(t,e){return{restrict:"E",controller:"YandexMapCtrl",controllerAs:"vm",templateUrl:"/src/route-test-app/components/yandex-map/yandex-map.html",scope:{},bindToController:{mapApi:"=",onDragPoint:"&"},link:function(n,o,r,i){i.construct(o[0].querySelector(".yandex-map"));var a=t(r.route)(n.$parent);angular.isArray(a)?n.$watchCollection(function(){return a.map(function(t){return t.coordinates.join("|")})},function(){i.redrawRoute(a)}):e.warn('You must pass array to "route" attribute of "yandex-map" directive'),n.$on("$destroy",i.destroy)}}}t.$inject=["$parse","$log"],angular.module("route-test-app").directive("yandexMap",t)}(),function(){"use strict";function t(t){t.decorator("ngNotify",["$delegate",function(t){function e(t,e,n){t.set(n,e)}var n=["info","error","success","warn","grimace"];return n.forEach(function(n){t[n]=e.bind(null,t,n)}),t}])}t.$inject=["$provide"],angular.module("route-test-app").config(t)}(),function(){"use strict";angular.module("route-test-app").run(["SvgIcons",function(t){t.loadSprite("./assets/svgs/sprite-141d14f0f6.svg")}])}(),function(){"use strict";angular.module("route-test-app").constant("MAP_DEFAULT_PARAMS",{controls:[],center:[55.773842,37.625675],zoom:10}).constant("MAP_DECOR_PARAMS",{line:{strokeColor:"#6c7174",strokeWidth:5,strokeOpacity:.5},label:{preset:"islands#circleIcon",iconColor:"#989c9e",draggable:!0},labelFirst:{iconColor:"#70E63C"},labelLast:{iconColor:"#FF4646"}})}(),function(){"use strict";function t(t,e){function n(){return"geolocation"in window.navigator}function o(){var o='You should not call "getCurrentCoordinates()" method when User client doen\'t support geolocation api. Use "isSupports()" method before call "getCurrentCoordinates()"',r=e.defer();return n()?window.navigator.geolocation.getCurrentPosition(function(t){r.resolve([t.coords.latitude,t.coords.longitude])},r.reject):(t.error(o),r.reject({message:o})),r.promise}this.isSupports=n,this.getCurrentCoordinates=o}t.$inject=["$log","$q"],angular.module("route-test-app").service("Geolocation",t)}(),function(){"use strict";function t(t){return void 0===window.SVGRect&&angular.element(document.documentElement).addClass("no-svg"),{restrict:"EA",templateUrl:"/src/svg-icons/blocks/svg-icon/svg-icon.html",scope:!0,link:function(e,n,o){o.type||t.error("You must pass type of icon"),e.type=o.type,e.size=o.size||"small"}}}t.$inject=["$log"],angular.module("svg-icons").directive("svgIcon",t)}(),function(){"use strict";function t(){function t(){function t(t){var e=new window.XMLHttpRequest;e.onload=function(){var t=document.createElement("x");t.innerHTML=e.responseText,document.body.insertBefore(t.firstChild,document.body.firstChild)},e.open("GET",t),e.send()}return{loadSprite:t}}this.$get=t}angular.module("svg-icons").provider("SvgIcons",t)}();
//# sourceMappingURL=app-3b62084bd8.js.map
